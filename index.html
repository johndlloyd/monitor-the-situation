<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>MONITOR THE SKI-TUATION // MONTANA SKI · TRAFFIC · WEATHER</title>
  <link rel="icon" type="image/svg+xml" href="favicon.svg">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <!-- HEADER -->
  <header id="header">
    <div class="header-left">
      <span class="logo-bracket">[</span>
      <span class="logo-text">MONITOR THE SKI-TUATION</span>
      <span class="logo-bracket">]</span>
      <span class="logo-sub">// SKI · TRAFFIC · WEATHER</span>
    </div>
    <div class="header-center">
      <span class="stat-label">FEEDS</span>
      <span class="stat-value" id="stat-total">--</span>
      <span class="stat-sep">|</span>
      <span class="stat-label">ON MAP</span>
      <span class="stat-value" id="stat-active">--</span>
    </div>
    <div class="header-right">
      <button class="btn-ghost" id="btn-map-toggle" title="View camera feeds">⊞ FEEDS</button>
      <button class="btn-ghost" id="btn-dark-toggle" title="Toggle dark mode">◑</button>
      <span class="clock" id="clock">--:--:--</span>
      <span class="tz">MST</span>
    </div>
  </header>

  <!-- MAIN LAYOUT -->
  <div id="main">

    <!-- LEFT PANEL: MAP + FILTERS -->
    <aside id="sidebar">
      <div id="map-container">
        <div id="map"></div>
        <div id="map-resizer"></div>
      </div>

      <!-- QUICK REGION BUTTONS -->
      <div class="filter-section">
        <div class="panel-label" style="margin-bottom:6px">// QUICK SELECT</div>
        <div class="region-grid">
          <button class="btn-region" style="grid-column: 1 / -1" data-lat="46.8797" data-lng="-110.3626" data-zoom="6">ALL MONTANA</button>
          <button class="btn-region" style="grid-column: 1 / -1" id="btn-ski-cams">⛷ SKI CAMS</button>
          <!-- Western MT -->
          <button class="btn-region" data-lat="46.8721" data-lng="-113.9940" data-zoom="11">MISSOULA</button>
          <button class="btn-region" data-lat="46.5958" data-lng="-112.0270" data-zoom="11">HELENA</button>
          <button class="btn-region" data-lat="46.0038" data-lng="-112.5348" data-zoom="11">BUTTE</button>
          <button class="btn-region" data-lat="48.1950" data-lng="-114.3160" data-zoom="11">KALISPELL</button>
          <button class="btn-region" data-lat="48.3887" data-lng="-114.3358" data-zoom="12">WHITEFISH</button>
          <button class="btn-region" data-lat="47.5268" data-lng="-111.2972" data-zoom="11">GREAT FALLS</button>
          <button class="btn-region" data-lat="48.5553" data-lng="-109.6839" data-zoom="11">HAVRE</button>
          <!-- Central MT -->
          <button class="btn-region" data-lat="47.0527" data-lng="-109.4309" data-zoom="11">LEWISTOWN</button>
          <!-- Eastern MT -->
          <button class="btn-region" data-lat="45.7833" data-lng="-108.5007" data-zoom="11">BILLINGS</button>
          <button class="btn-region" data-lat="45.9163" data-lng="-112.5296" data-zoom="11">BOZEMAN</button>
          <button class="btn-region" data-lat="46.4082" data-lng="-105.8406" data-zoom="11">MILES CITY</button>
          <button class="btn-region" data-lat="47.1053" data-lng="-104.7114" data-zoom="11">GLENDIVE</button>
          <button class="btn-region" data-lat="48.1225" data-lng="-106.6251" data-zoom="11">WOLF POINT</button>
          <!-- Key Passes / Routes -->
          <button class="btn-region" data-lat="47.4536" data-lng="-115.6951" data-zoom="12">LOOKOUT PASS</button>
          <button class="btn-region" data-lat="46.7185" data-lng="-113.2953" data-zoom="12">BEARMOUTH</button>
          <button class="btn-region" data-lat="46.8714" data-lng="-113.4230" data-zoom="12">GREENOUGH</button>
          <button class="btn-region" data-lat="47.0230" data-lng="-114.3887" data-zoom="12">NINEMILE</button>
          <button class="btn-region" data-lat="47.2986" data-lng="-115.1036" data-zoom="12">ST. REGIS</button>
          <button class="btn-region" data-lat="46.8038" data-lng="-114.0980" data-zoom="12">LOLO</button>
          <button class="btn-region" data-lat="47.0221" data-lng="-114.1124" data-zoom="12">EVARO HILL</button>
          <!-- Yellowstone Area -->
          <button class="btn-region" data-lat="45.0150" data-lng="-110.6900" data-zoom="10">YELLOWSTONE</button>
          <button class="btn-region" data-lat="45.6770" data-lng="-111.0429" data-zoom="11">LIVINGSTON</button>
          <button class="btn-region" data-lat="44.9000" data-lng="-110.7000" data-zoom="11">COOKE CITY</button>
        </div>
      </div>

    </aside>

    <!-- RIGHT PANEL: CAMERA GRID -->
    <main id="grid-panel">
      <div class="panel-header">
        <div class="grid-size-controls">
          <button class="btn-ghost" id="btn-fewer" title="Fewer cameras">− FEWER</button>
          <span class="grid-info" id="grid-info">5×5</span>
          <button class="btn-ghost" id="btn-more"  title="More cameras">+ MORE</button>
          <button class="btn-ghost" id="btn-view-all" title="View all cameras on map">VIEW ALL</button>
        </div>
        <div class="refresh-controls">
          <label class="filter-label">REFRESH</label>
          <select class="filter-select" id="refresh-rate">
            <option value="0">MANUAL</option>
            <option value="30000">30s</option>
            <option value="60000" selected>60s</option>
            <option value="120000">2m</option>
            <option value="300000">5m</option>
          </select>
          <button class="btn-ghost" id="btn-refresh-now" title="Refresh all now">NOW</button>
        </div>
      </div>

      <div id="loading-screen">
        <div class="loading-inner">
          <div class="loading-logo">[SKITUATION]</div>
          <div class="loading-bar-wrap"><div class="loading-bar" id="loading-bar"></div></div>
          <div class="loading-status" id="loading-status">CONNECTING TO CAMERA NETWORK...</div>
        </div>
      </div>

      <div id="camera-grid"></div>

      <div id="no-results" style="display:none">
        <span class="no-results-text">// NO FEEDS MATCH CURRENT FILTER CRITERIA</span>
      </div>
    </main>
  </div>

  <!-- POP-OUT MODAL -->
  <div id="modal-overlay" style="display:none" onclick="closeModal()">
    <div id="modal" onclick="event.stopPropagation()">
      <div id="modal-header">
        <div id="modal-title">--</div>
        <div class="modal-controls">
          <span id="modal-id" class="modal-meta"></span>
          <button class="btn-ghost" id="btn-modal-prev" title="Previous camera">◀</button>
          <button class="btn-ghost" id="btn-modal-next" title="Next camera">▶</button>
          <button class="btn-close" id="btn-modal-close" onclick="closeModal()">✕</button>
        </div>
      </div>
      <div id="modal-img-wrap">
        <img id="modal-img" src="" alt="Camera Feed">
        <div id="modal-spinner" class="spinner"></div>
        <div id="modal-timestamp"></div>
      </div>
      <div id="modal-footer">
        <span id="modal-road" class="modal-meta"></span>
        <span id="modal-coords" class="modal-meta"></span>
        <button class="btn-ghost" id="btn-modal-refresh" onclick="refreshModal()">↺ REFRESH</button>
        <button class="btn-ghost" id="btn-map-goto" onclick="gotoOnMap()">⊕ MAP</button>
        <button class="btn-fullscreen-footer" id="btn-fullscreen" title="Full screen">⤢ FULL SCREEN</button>
      </div>
    </div>
  </div>

  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <script src="app.js"></script>
</body>
</html>
